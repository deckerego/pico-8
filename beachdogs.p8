pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
function _init()
 p1 = {}
 p1.num = 0
 p1.speed = 1.25
 p1.x = 28
 p1.y = 32
 p1.spr = 0
 p1.tick = 0
 p1.west = false
 p1.disc = true

 p2 = {}
 p2.num = 1
 p2.speed = 1.25
 p2.x = 82
 p2.y = 32
 p2.spr = 16
 p2.tick = 0
 p2.west = true
 p2.disc = false

 disc = {}
 disc.angle = -1
 disc.speed = 2
 disc.x = 0
 disc.y = 0
 disc.spr = 116
 disc.tick = 0
end

function _update()
 move(p1)
 move(p2)
 if(disc.angle >= 0) fly(disc)
end

function _draw()
 cls()

 map(0, 0)

 local p1idx = sprite_idx(p1, 4, 3)
 spr((p1.spr + p1idx) * 2, p1.x - 8, p1.y, 2, 2, p1.west, false)

 local p2idx = sprite_idx(p2, 4, 3)
 spr((p2.spr + p2idx) * 2, p2.x + 8, p2.y, 2, 2, p2.west, false)

 if disc.angle >= 0 then
  local discidx = sprite_idx(disc, 1, 2)
  spr((disc.spr + discidx), disc.x, disc.y)
 end

 print(band(btn(), 0x00FF * (0x100 ^ p2.num)))
end

function move(plr)
 local ctrlmask = 0x00FF * (0x100 ^ plr.num)
 if(band(btn(), ctrlmask) == 0) idle(plr)

 if(btn(⬅️, plr.num)) move_left(plr)
 if(btn(➡️, plr.num)) move_right(plr)
 if(btn(⬆️, plr.num)) move_up(plr)
 if(btn(⬇️, plr.num)) move_down(plr)
 if(btnp(❎, plr.num)) action(plr, btn())
end

function fly(obj)
 obj.x = obj.x + obj.speed * cos(obj.angle)
 obj.y = obj.y + obj.speed * sin(obj.angle)

 if catch(obj.x, obj.y) then
  obj.tick = 0
  obj.angle = -1
 else
  obj.tick += 1
 end
end

function idle(plr)
 plr.tick = 0
end

function move_up(plr)
 plr.tick += 1
 plr.y -= plr.speed
end

function move_down(plr)
 plr.tick += 1
 plr.y += plr.speed
end

function move_right(plr)
 if not collision(plr.x + 15 + plr.speed, plr.y) then
  plr.tick += 1
  plr.x += plr.speed
 end

 plr.west = false
end

function move_left(plr)
 if not collision(plr.x - plr.speed, plr.y) then
  plr.tick += 1
  plr.x -= plr.speed
 end

 plr.west = true
end

function sprite_idx(obj, frames, speed)
 local idx = flr(obj.tick / speed)
 if idx > frames then
  obj.tick = 0
  idx = 0
 end

 return idx
end

function action(plr)
 if plr.disc then
  local orientation = plr.west and -1 or 1

  if(plr.west) disc.angle = 0.5 else disc.angle = 0.0
  if(btn(⬆️, plr.num)) disc.angle = disc.angle + (0.125 * orientation)
  if(btn(⬇️, plr.num)) disc.angle = disc.angle - (0.125 * orientation)
  if(disc.angle < 0) disc.angle += 1

  sfx(0)
  disc.x = plr.x
  disc.y = plr.y
  //plr.disc = false
 end
end

function collision(x, y)
 local colx = x / 8
 local coly = y / 8
 local cell = mget(colx, coly)
 return fget(cell, 0)
end

function catch(x, y)
 return x >= p2.x - 4 and x <= p2.x + 4 and y >= p2.y - 4 and y <= p2.y + 4
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000095000000000000000900000000000000950000000000000990000000000000009500000000000000000000000000000000000000000000000000000
00900000009990000000000095999000000000000090000000000000099990000000000000999000000000000000000000000000000000000000000000000000
09000000099a190000000000099a1994990000000999900090000000059a190090000000099a1900000000000000000000000000000000000000000000000000
990000000999999499000000c99999905995ca00099a190099000000999999949900000009999994000000000000000000000000000000000000000000000000
999dcaccc9999990099dcaccc99999000999caccc9999994999dcaccc9999990999dcaccc9999990000000000000000000000000000000000000000000000000
0999cacc999999000599cacc999990000599cacc999999900999cacc999990000999cacc99999900000000000000000000000000000000000000000000000000
0099cac9999900000099cac9999900000099cac9999900000099cac9999000000099cac999990000000000000000000000000000000000000000000000000000
09995000999500009599000099999000959900009995000009995000999000000099500099950000000000000000000000000000000000000000000000000000
09959000099590005990000009955990599000000995900000959005995000000095909995900000000000000000000000000000000000000000000000000000
00900900009000009900000000099900990000000090000000095909950000000999900909000000000000000000000000000000000000000000000000000000
00090000009900000000000000000000000000000099000000009090000000000909000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000d5000000000000000d00000000000000d50000000000000dd000000000000000d500000000000000000000000000000000000000000000000000000
00d0000000ddd00000000000d5ddd0000000000000d00000000000000dddd0000000000000ddd000000000000000000000000000000000000000000000000000
0d0000000ddf1d00000000000ddf1dd4dd0000000dddd000d000000005df1d00d00000000ddf1d00000000000000000000000000000000000000000000000000
dd0000008dddddd4dd0000008dddddd05dd5dd000ddf1d00dd0000008dddddd4dd0000008dddddd4000000000000000000000000000000000000000000000000
ddddddddd8ddddd00dddddddd8dddd000dddddddd8ddddd4ddddddddd8ddddd0ddddddddd88dddd0000000000000000000000000000000000000000000000000
0ddddddddd88dd0005dddddddd88d00005dddddddd8dddd00ddddddddd8dd0000dddddddddd8dd00000000000000000000000000000000000000000000000000
00dddddddddd000000dddddddddd000000ddddddddd8000000ddddddddd0000000dddddddddd0000000000000000000000000000000000000000000000000000
0ddd5000ddd50000d5dd0000ddddd000d5dd0000ddd500000ddd5000ddd0000000dd5000ddd50000000000000000000000000000000000000000000000000000
0dd5d0000dd5d0005dd000000dd55dd05dd000000dd5d00000d5d005dd50000000d5d0ddd5d00000000000000000000000000000000000000000000000000000
00d00d0000d00000dd000000000ddd00dd00000000d00000000d5d0dd50000000dddd00d0d000000000000000000000000000000000000000000000000000000
000d000000dd000000000000000000000000000000dd00000000d0d0000000000d0d000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa6a5daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaafffaaaaaaaaaaaaaaaaaa6a65daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaffffaaaaaaaaaaaaaaaaaaa6a5daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaafffffaaaaaffaaaaaaaaaaaa6a65daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaafffaaaaaaaffaaaaaaaaaafaa6a5daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaffaaaaaaaaaaaaaaaaaaaafa6a65daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaffaa6a5daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaaaaaaaafffa6a65daa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaaaaaaafffa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaaaaaafffaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaffaaaaffffaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaffaaaafffaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaaffffaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaffaaaaaafffffaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaafffaaaaaffffaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaafffaaaffffaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaffffaaaafffaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaffffffaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaafffffaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaafffaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaffffaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaffffaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaffaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaffaaaaaaaaffaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaffaaaaaaafffaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaaafffaaaaa00cccc00000cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaaaaffffaaaaaa0cc6ccc000cccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaaaaaaafffffaaaaaaacccc6ccc0ccc6cc000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaffaaaaaaaaffffaaaaaaaaa0dccccd00dc6ccd000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaffaaaaafffffaaaaaaaaaaa00dddd0000dccd0000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaaffffffaaaaaaaaaaff00000000000dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000
aaaaaaaaaaaaaffffaaaaaaaaaaaaaff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0002000200020002000200000000000000000000000000000000000000000000000200020002000200020000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040400000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
4041404142434344404142434041424300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041505152534344505152404142435300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5051606162635344606162505152536300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6061707172736344707172606162637300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7071727371727344404142707172734300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4041424041424344404142434041424300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5051525051525344505152535051525300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6061626061626344606162636061626300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7071727071727344707172737071727300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
010100001916015160111600f1600e1600d1600c1600c1600c1600c1500c1500c1500d1500f150121501714020140091500d150121501a1601e1601826020260262602b350000400003000000000000000000000
